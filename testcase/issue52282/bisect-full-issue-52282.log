Start to detect regression causing commit for issue 52282
Bisecting: a merge base must be tested
[6701bf1527c7386a82396a1ecfb5322872daa2b3] ddl: create table accelerate (#49687)
running  '/Users/yichenhan/workload/regression_detection//regression_detect_runtest.sh' '127.0.0.1' '4000' 'root' 'test' '/Users/yichenhan/workload/regression_detection/testcase/issue52282/issue52282_testcase.sql' '/Users/yichenhan/workload/regression_detection/testcase/issue52282/issue52282.result' '/Users/yichenhan/workload/regression_detection/testcase/issue52282' '/Users/yichenhan/dummy/tidb' '1' '100' '/Users/yichenhan/workload/regression_detection/testcase/issue52282/bisect-status-issue-52282.log'
CGO_ENABLED=1  GO111MODULE=on go build -tags codes  -ldflags '-X "github.com/pingcap/tidb/pkg/parser/mysql.TiDBReleaseVersion=v7.6.0-alpha-703-g6701bf1527-dirty" -X "github.com/pingcap/tidb/pkg/util/versioninfo.TiDBBuildTS=2024-04-03 06:29:22" -X "github.com/pingcap/tidb/pkg/util/versioninfo.TiDBGitHash=6701bf1527c7386a82396a1ecfb5322872daa2b3" -X "github.com/pingcap/tidb/pkg/util/versioninfo.TiDBGitBranch=HEAD" -X "github.com/pingcap/tidb/pkg/util/versioninfo.TiDBEdition=Community" ' -o bin/tidb-server ./cmd/tidb-server
Build TiDB Server successfully!
mysqld is alive
--------------------------------------------------------------------------------------
-----------------Regression Test Result on 6701bf1527c7386a82396a1ecfb5322872daa2b3-----------------
Server on 6701bf1527c7386a82396a1ecfb5322872daa2b3 started.
Validation passed. 6701bf1527c7386a82396a1ecfb5322872daa2b3 is a good label
-----------------Test Case-----------------
mysql -h 127.0.0.1 -P 4000 -u root -D test --local-infile=true < issue52282_testcase.sql
issue52282_testcase.sql: 
drop table if exists `t`;
create table t (a int, b varchar(255), primary key (a)) partition by hash(a) partitions 2;
insert into t values (1, '1'), (2, '2'), (3, '3');
set @@tidb_partition_prune_mode='static';
select * from t tablesample regions();
set @@tidb_partition_prune_mode='dynamic';
select * from t tablesample regions();
set @@tidb_partition_prune_mode='static-only';
select * from t tablesample regions();
set @@tidb_partition_prune_mode='dynamic-only';
select * from t tablesample regions();
-----------------Test Result-----------------
Result : 
a	b
2	2
1	1
a	b
2	2
1	1
a	b
2	2
1	1
a	b
2	2
1	1
-----------------TiDB Version-----------------
tidb_version()
Release Version: v7.6.0-alpha-703-g6701bf1527-dirty
Edition: Community
Git Commit Hash: 6701bf1527c7386a82396a1ecfb5322872daa2b3
Git Branch: HEAD
UTC Build Time: 2024-04-03 06:29:22
GoVersion: go1.21.4
Race Enabled: false
Check Table Before Drop: false
Store: unistore

-----------------End of regression test on 6701bf1527c7386a82396a1ecfb5322872daa2b3-----------------
--------------------------------------------------------------------------------------
Bisecting: 312 revisions left to test after this (roughly 8 steps)
[8e2e149ac8616f5231651a4d32fd5bbc0ca29b8d] planner: fix typos and add more comments (#51192)
running  '/Users/yichenhan/workload/regression_detection//regression_detect_runtest.sh' '127.0.0.1' '4000' 'root' 'test' '/Users/yichenhan/workload/regression_detection/testcase/issue52282/issue52282_testcase.sql' '/Users/yichenhan/workload/regression_detection/testcase/issue52282/issue52282.result' '/Users/yichenhan/workload/regression_detection/testcase/issue52282' '/Users/yichenhan/dummy/tidb' '1' '100' '/Users/yichenhan/workload/regression_detection/testcase/issue52282/bisect-status-issue-52282.log'
CGO_ENABLED=1  GO111MODULE=on go build -tags codes  -ldflags '-X "github.com/pingcap/tidb/pkg/parser/mysql.TiDBReleaseVersion=v8.0.0-alpha-261-g8e2e149ac8-dirty" -X "github.com/pingcap/tidb/pkg/util/versioninfo.TiDBBuildTS=2024-04-03 06:29:50" -X "github.com/pingcap/tidb/pkg/util/versioninfo.TiDBGitHash=8e2e149ac8616f5231651a4d32fd5bbc0ca29b8d" -X "github.com/pingcap/tidb/pkg/util/versioninfo.TiDBGitBranch=HEAD" -X "github.com/pingcap/tidb/pkg/util/versioninfo.TiDBEdition=Community" ' -o bin/tidb-server ./cmd/tidb-server
Build TiDB Server successfully!
mysqld is alive
--------------------------------------------------------------------------------------
-----------------Regression Test Result on 8e2e149ac8616f5231651a4d32fd5bbc0ca29b8d-----------------
Server on 8e2e149ac8616f5231651a4d32fd5bbc0ca29b8d started.
Validation passed. 8e2e149ac8616f5231651a4d32fd5bbc0ca29b8d is a good label
-----------------Test Case-----------------
mysql -h 127.0.0.1 -P 4000 -u root -D test --local-infile=true < issue52282_testcase.sql
issue52282_testcase.sql: 
drop table if exists `t`;
create table t (a int, b varchar(255), primary key (a)) partition by hash(a) partitions 2;
insert into t values (1, '1'), (2, '2'), (3, '3');
set @@tidb_partition_prune_mode='static';
select * from t tablesample regions();
set @@tidb_partition_prune_mode='dynamic';
select * from t tablesample regions();
set @@tidb_partition_prune_mode='static-only';
select * from t tablesample regions();
set @@tidb_partition_prune_mode='dynamic-only';
select * from t tablesample regions();
-----------------Test Result-----------------
Result : 
a	b
2	2
1	1
a	b
2	2
1	1
a	b
2	2
1	1
a	b
2	2
1	1
-----------------TiDB Version-----------------
tidb_version()
Release Version: v8.0.0-alpha-261-g8e2e149ac8-dirty
Edition: Community
Git Commit Hash: 8e2e149ac8616f5231651a4d32fd5bbc0ca29b8d
Git Branch: HEAD
UTC Build Time: 2024-04-03 06:29:50
GoVersion: go1.21.4
Race Enabled: false
Check Table Before Drop: false
Store: unistore

-----------------End of regression test on 8e2e149ac8616f5231651a4d32fd5bbc0ca29b8d-----------------
--------------------------------------------------------------------------------------
Bisecting: 156 revisions left to test after this (roughly 7 steps)
[6ec70f17b5651c49229dfd81b23ce7fedb4313a7] bootstrap: Modify column sizes in constant.go and bootstrap.go (#51457)
running  '/Users/yichenhan/workload/regression_detection//regression_detect_runtest.sh' '127.0.0.1' '4000' 'root' 'test' '/Users/yichenhan/workload/regression_detection/testcase/issue52282/issue52282_testcase.sql' '/Users/yichenhan/workload/regression_detection/testcase/issue52282/issue52282.result' '/Users/yichenhan/workload/regression_detection/testcase/issue52282' '/Users/yichenhan/dummy/tidb' '1' '100' '/Users/yichenhan/workload/regression_detection/testcase/issue52282/bisect-status-issue-52282.log'
CGO_ENABLED=1  GO111MODULE=on go build -tags codes  -ldflags '-X "github.com/pingcap/tidb/pkg/parser/mysql.TiDBReleaseVersion=v8.0.0-alpha-417-g6ec70f17b5-dirty" -X "github.com/pingcap/tidb/pkg/util/versioninfo.TiDBBuildTS=2024-04-03 06:30:55" -X "github.com/pingcap/tidb/pkg/util/versioninfo.TiDBGitHash=6ec70f17b5651c49229dfd81b23ce7fedb4313a7" -X "github.com/pingcap/tidb/pkg/util/versioninfo.TiDBGitBranch=HEAD" -X "github.com/pingcap/tidb/pkg/util/versioninfo.TiDBEdition=Community" ' -o bin/tidb-server ./cmd/tidb-server
Build TiDB Server successfully!
mysqld is alive
--------------------------------------------------------------------------------------
-----------------Regression Test Result on 6ec70f17b5651c49229dfd81b23ce7fedb4313a7-----------------
Server on 6ec70f17b5651c49229dfd81b23ce7fedb4313a7 started.
Validation passed. 6ec70f17b5651c49229dfd81b23ce7fedb4313a7 is a good label
-----------------Test Case-----------------
mysql -h 127.0.0.1 -P 4000 -u root -D test --local-infile=true < issue52282_testcase.sql
issue52282_testcase.sql: 
drop table if exists `t`;
create table t (a int, b varchar(255), primary key (a)) partition by hash(a) partitions 2;
insert into t values (1, '1'), (2, '2'), (3, '3');
set @@tidb_partition_prune_mode='static';
select * from t tablesample regions();
set @@tidb_partition_prune_mode='dynamic';
select * from t tablesample regions();
set @@tidb_partition_prune_mode='static-only';
select * from t tablesample regions();
set @@tidb_partition_prune_mode='dynamic-only';
select * from t tablesample regions();
-----------------Test Result-----------------
Result : 
a	b
2	2
1	1
a	b
2	2
1	1
a	b
2	2
1	1
a	b
2	2
1	1
-----------------TiDB Version-----------------
tidb_version()
Release Version: v8.0.0-alpha-417-g6ec70f17b5-dirty
Edition: Community
Git Commit Hash: 6ec70f17b5651c49229dfd81b23ce7fedb4313a7
Git Branch: HEAD
UTC Build Time: 2024-04-03 06:30:55
GoVersion: go1.21.4
Race Enabled: false
Check Table Before Drop: false
Store: unistore

-----------------End of regression test on 6ec70f17b5651c49229dfd81b23ce7fedb4313a7-----------------
--------------------------------------------------------------------------------------
Bisecting: 78 revisions left to test after this (roughly 6 steps)
[954592375dc8189e59ca92bd17f366d4b4c3f2aa] log: Support a dedicated log file to save general log (#51249)
running  '/Users/yichenhan/workload/regression_detection//regression_detect_runtest.sh' '127.0.0.1' '4000' 'root' 'test' '/Users/yichenhan/workload/regression_detection/testcase/issue52282/issue52282_testcase.sql' '/Users/yichenhan/workload/regression_detection/testcase/issue52282/issue52282.result' '/Users/yichenhan/workload/regression_detection/testcase/issue52282' '/Users/yichenhan/dummy/tidb' '1' '100' '/Users/yichenhan/workload/regression_detection/testcase/issue52282/bisect-status-issue-52282.log'
CGO_ENABLED=1  GO111MODULE=on go build -tags codes  -ldflags '-X "github.com/pingcap/tidb/pkg/parser/mysql.TiDBReleaseVersion=v8.0.0-alpha-495-g954592375d-dirty" -X "github.com/pingcap/tidb/pkg/util/versioninfo.TiDBBuildTS=2024-04-03 06:31:44" -X "github.com/pingcap/tidb/pkg/util/versioninfo.TiDBGitHash=954592375dc8189e59ca92bd17f366d4b4c3f2aa" -X "github.com/pingcap/tidb/pkg/util/versioninfo.TiDBGitBranch=HEAD" -X "github.com/pingcap/tidb/pkg/util/versioninfo.TiDBEdition=Community" ' -o bin/tidb-server ./cmd/tidb-server
Build TiDB Server successfully!
mysqld is alive
--------------------------------------------------------------------------------------
-----------------Regression Test Result on 954592375dc8189e59ca92bd17f366d4b4c3f2aa-----------------
Server on 954592375dc8189e59ca92bd17f366d4b4c3f2aa started.
Validation passed. 954592375dc8189e59ca92bd17f366d4b4c3f2aa is a good label
-----------------Test Case-----------------
mysql -h 127.0.0.1 -P 4000 -u root -D test --local-infile=true < issue52282_testcase.sql
issue52282_testcase.sql: 
drop table if exists `t`;
create table t (a int, b varchar(255), primary key (a)) partition by hash(a) partitions 2;
insert into t values (1, '1'), (2, '2'), (3, '3');
set @@tidb_partition_prune_mode='static';
select * from t tablesample regions();
set @@tidb_partition_prune_mode='dynamic';
select * from t tablesample regions();
set @@tidb_partition_prune_mode='static-only';
select * from t tablesample regions();
set @@tidb_partition_prune_mode='dynamic-only';
select * from t tablesample regions();
-----------------Test Result-----------------
Result : 
a	b
2	2
1	1
a	b
2	2
1	1
a	b
2	2
1	1
a	b
2	2
1	1
-----------------TiDB Version-----------------
tidb_version()
Release Version: v8.0.0-alpha-495-g954592375d-dirty
Edition: Community
Git Commit Hash: 954592375dc8189e59ca92bd17f366d4b4c3f2aa
Git Branch: HEAD
UTC Build Time: 2024-04-03 06:31:44
GoVersion: go1.21.4
Race Enabled: false
Check Table Before Drop: false
Store: unistore

-----------------End of regression test on 954592375dc8189e59ca92bd17f366d4b4c3f2aa-----------------
--------------------------------------------------------------------------------------
Bisecting: 39 revisions left to test after this (roughly 5 steps)
[cbd41115f32b8f49c105473cc65291cdc8d26da6] br: skip loading stats into memory if set `--load-stats` to false (#51535)
running  '/Users/yichenhan/workload/regression_detection//regression_detect_runtest.sh' '127.0.0.1' '4000' 'root' 'test' '/Users/yichenhan/workload/regression_detection/testcase/issue52282/issue52282_testcase.sql' '/Users/yichenhan/workload/regression_detection/testcase/issue52282/issue52282.result' '/Users/yichenhan/workload/regression_detection/testcase/issue52282' '/Users/yichenhan/dummy/tidb' '1' '100' '/Users/yichenhan/workload/regression_detection/testcase/issue52282/bisect-status-issue-52282.log'
CGO_ENABLED=1  GO111MODULE=on go build -tags codes  -ldflags '-X "github.com/pingcap/tidb/pkg/parser/mysql.TiDBReleaseVersion=v8.0.0-alpha-534-gcbd41115f3-dirty" -X "github.com/pingcap/tidb/pkg/util/versioninfo.TiDBBuildTS=2024-04-03 06:32:44" -X "github.com/pingcap/tidb/pkg/util/versioninfo.TiDBGitHash=cbd41115f32b8f49c105473cc65291cdc8d26da6" -X "github.com/pingcap/tidb/pkg/util/versioninfo.TiDBGitBranch=HEAD" -X "github.com/pingcap/tidb/pkg/util/versioninfo.TiDBEdition=Community" ' -o bin/tidb-server ./cmd/tidb-server
Build TiDB Server successfully!
mysqld is alive
--------------------------------------------------------------------------------------
-----------------Regression Test Result on cbd41115f32b8f49c105473cc65291cdc8d26da6-----------------
Server on cbd41115f32b8f49c105473cc65291cdc8d26da6 started.
Validation passed. cbd41115f32b8f49c105473cc65291cdc8d26da6 is a good label
-----------------Test Case-----------------
mysql -h 127.0.0.1 -P 4000 -u root -D test --local-infile=true < issue52282_testcase.sql
issue52282_testcase.sql: 
drop table if exists `t`;
create table t (a int, b varchar(255), primary key (a)) partition by hash(a) partitions 2;
insert into t values (1, '1'), (2, '2'), (3, '3');
set @@tidb_partition_prune_mode='static';
select * from t tablesample regions();
set @@tidb_partition_prune_mode='dynamic';
select * from t tablesample regions();
set @@tidb_partition_prune_mode='static-only';
select * from t tablesample regions();
set @@tidb_partition_prune_mode='dynamic-only';
select * from t tablesample regions();
-----------------Test Result-----------------
Result : 
a	b
2	2
1	1
a	b
2	2
1	1
a	b
2	2
1	1
a	b
2	2
1	1
-----------------TiDB Version-----------------
tidb_version()
Release Version: v8.0.0-alpha-534-gcbd41115f3-dirty
Edition: Community
Git Commit Hash: cbd41115f32b8f49c105473cc65291cdc8d26da6
Git Branch: HEAD
UTC Build Time: 2024-04-03 06:32:44
GoVersion: go1.21.4
Race Enabled: false
Check Table Before Drop: false
Store: unistore

-----------------End of regression test on cbd41115f32b8f49c105473cc65291cdc8d26da6-----------------
--------------------------------------------------------------------------------------
Bisecting: 19 revisions left to test after this (roughly 4 steps)
[24524439112106be61d1cfdb94cc945f8202ebcd] external: make global sort `common.Range` unencoded (#51900) (#51969)
running  '/Users/yichenhan/workload/regression_detection//regression_detect_runtest.sh' '127.0.0.1' '4000' 'root' 'test' '/Users/yichenhan/workload/regression_detection/testcase/issue52282/issue52282_testcase.sql' '/Users/yichenhan/workload/regression_detection/testcase/issue52282/issue52282.result' '/Users/yichenhan/workload/regression_detection/testcase/issue52282' '/Users/yichenhan/dummy/tidb' '1' '100' '/Users/yichenhan/workload/regression_detection/testcase/issue52282/bisect-status-issue-52282.log'
CGO_ENABLED=1  GO111MODULE=on go build -tags codes  -ldflags '-X "github.com/pingcap/tidb/pkg/parser/mysql.TiDBReleaseVersion=v8.0.0-alpha-554-g2452443911-dirty" -X "github.com/pingcap/tidb/pkg/util/versioninfo.TiDBBuildTS=2024-04-03 06:33:25" -X "github.com/pingcap/tidb/pkg/util/versioninfo.TiDBGitHash=24524439112106be61d1cfdb94cc945f8202ebcd" -X "github.com/pingcap/tidb/pkg/util/versioninfo.TiDBGitBranch=HEAD" -X "github.com/pingcap/tidb/pkg/util/versioninfo.TiDBEdition=Community" ' -o bin/tidb-server ./cmd/tidb-server
Build TiDB Server successfully!
mysqld is alive
--------------------------------------------------------------------------------------
-----------------Regression Test Result on 24524439112106be61d1cfdb94cc945f8202ebcd-----------------
Server on 24524439112106be61d1cfdb94cc945f8202ebcd started.
Validation passed. 24524439112106be61d1cfdb94cc945f8202ebcd is a good label
-----------------Test Case-----------------
mysql -h 127.0.0.1 -P 4000 -u root -D test --local-infile=true < issue52282_testcase.sql
issue52282_testcase.sql: 
drop table if exists `t`;
create table t (a int, b varchar(255), primary key (a)) partition by hash(a) partitions 2;
insert into t values (1, '1'), (2, '2'), (3, '3');
set @@tidb_partition_prune_mode='static';
select * from t tablesample regions();
set @@tidb_partition_prune_mode='dynamic';
select * from t tablesample regions();
set @@tidb_partition_prune_mode='static-only';
select * from t tablesample regions();
set @@tidb_partition_prune_mode='dynamic-only';
select * from t tablesample regions();
-----------------Test Result-----------------
Result : 
a	b
2	2
1	1
a	b
2	2
1	1
a	b
2	2
1	1
a	b
2	2
1	1
-----------------TiDB Version-----------------
tidb_version()
Release Version: v8.0.0-alpha-554-g2452443911-dirty
Edition: Community
Git Commit Hash: 24524439112106be61d1cfdb94cc945f8202ebcd
Git Branch: HEAD
UTC Build Time: 2024-04-03 06:33:25
GoVersion: go1.21.4
Race Enabled: false
Check Table Before Drop: false
Store: unistore

-----------------End of regression test on 24524439112106be61d1cfdb94cc945f8202ebcd-----------------
--------------------------------------------------------------------------------------
Bisecting: 9 revisions left to test after this (roughly 3 steps)
[e359ebd0fcd22e7cb65b88fcc841ae14e880f3cc] br: revise tidb-lightning.toml for conflict detection (#52033) (#52044)
running  '/Users/yichenhan/workload/regression_detection//regression_detect_runtest.sh' '127.0.0.1' '4000' 'root' 'test' '/Users/yichenhan/workload/regression_detection/testcase/issue52282/issue52282_testcase.sql' '/Users/yichenhan/workload/regression_detection/testcase/issue52282/issue52282.result' '/Users/yichenhan/workload/regression_detection/testcase/issue52282' '/Users/yichenhan/dummy/tidb' '1' '100' '/Users/yichenhan/workload/regression_detection/testcase/issue52282/bisect-status-issue-52282.log'
CGO_ENABLED=1  GO111MODULE=on go build -tags codes  -ldflags '-X "github.com/pingcap/tidb/pkg/parser/mysql.TiDBReleaseVersion=v8.0.0-alpha-564-ge359ebd0fc-dirty" -X "github.com/pingcap/tidb/pkg/util/versioninfo.TiDBBuildTS=2024-04-03 06:34:14" -X "github.com/pingcap/tidb/pkg/util/versioninfo.TiDBGitHash=e359ebd0fcd22e7cb65b88fcc841ae14e880f3cc" -X "github.com/pingcap/tidb/pkg/util/versioninfo.TiDBGitBranch=HEAD" -X "github.com/pingcap/tidb/pkg/util/versioninfo.TiDBEdition=Community" ' -o bin/tidb-server ./cmd/tidb-server
Build TiDB Server successfully!
mysqld is alive
--------------------------------------------------------------------------------------
-----------------Regression Test Result on e359ebd0fcd22e7cb65b88fcc841ae14e880f3cc-----------------
Server on e359ebd0fcd22e7cb65b88fcc841ae14e880f3cc started.
Validation passed. e359ebd0fcd22e7cb65b88fcc841ae14e880f3cc is a good label
-----------------Test Case-----------------
mysql -h 127.0.0.1 -P 4000 -u root -D test --local-infile=true < issue52282_testcase.sql
issue52282_testcase.sql: 
drop table if exists `t`;
create table t (a int, b varchar(255), primary key (a)) partition by hash(a) partitions 2;
insert into t values (1, '1'), (2, '2'), (3, '3');
set @@tidb_partition_prune_mode='static';
select * from t tablesample regions();
set @@tidb_partition_prune_mode='dynamic';
select * from t tablesample regions();
set @@tidb_partition_prune_mode='static-only';
select * from t tablesample regions();
set @@tidb_partition_prune_mode='dynamic-only';
select * from t tablesample regions();
-----------------Test Result-----------------
Result : 
a	b
2	2
1	1
a	b
2	2
1	1
a	b
2	2
1	1
a	b
2	2
1	1
-----------------TiDB Version-----------------
tidb_version()
Release Version: v8.0.0-alpha-564-ge359ebd0fc-dirty
Edition: Community
Git Commit Hash: e359ebd0fcd22e7cb65b88fcc841ae14e880f3cc
Git Branch: HEAD
UTC Build Time: 2024-04-03 06:34:14
GoVersion: go1.21.4
Race Enabled: false
Check Table Before Drop: false
Store: unistore

-----------------End of regression test on e359ebd0fcd22e7cb65b88fcc841ae14e880f3cc-----------------
--------------------------------------------------------------------------------------
Bisecting: 4 revisions left to test after this (roughly 2 steps)
[d4ef3b269e51e05688d76ef11ea36ccde51febad] restore: use a limited workpool (#51872) (#52110)
running  '/Users/yichenhan/workload/regression_detection//regression_detect_runtest.sh' '127.0.0.1' '4000' 'root' 'test' '/Users/yichenhan/workload/regression_detection/testcase/issue52282/issue52282_testcase.sql' '/Users/yichenhan/workload/regression_detection/testcase/issue52282/issue52282.result' '/Users/yichenhan/workload/regression_detection/testcase/issue52282' '/Users/yichenhan/dummy/tidb' '1' '100' '/Users/yichenhan/workload/regression_detection/testcase/issue52282/bisect-status-issue-52282.log'
CGO_ENABLED=1  GO111MODULE=on go build -tags codes  -ldflags '-X "github.com/pingcap/tidb/pkg/parser/mysql.TiDBReleaseVersion=v8.0.0-alpha-569-gd4ef3b269e-dirty" -X "github.com/pingcap/tidb/pkg/util/versioninfo.TiDBBuildTS=2024-04-03 06:35:04" -X "github.com/pingcap/tidb/pkg/util/versioninfo.TiDBGitHash=d4ef3b269e51e05688d76ef11ea36ccde51febad" -X "github.com/pingcap/tidb/pkg/util/versioninfo.TiDBGitBranch=HEAD" -X "github.com/pingcap/tidb/pkg/util/versioninfo.TiDBEdition=Community" ' -o bin/tidb-server ./cmd/tidb-server
Build TiDB Server successfully!
mysqld is alive
--------------------------------------------------------------------------------------
-----------------Regression Test Result on d4ef3b269e51e05688d76ef11ea36ccde51febad-----------------
Server on d4ef3b269e51e05688d76ef11ea36ccde51febad started.
Validation passed. d4ef3b269e51e05688d76ef11ea36ccde51febad is a good label
-----------------Test Case-----------------
mysql -h 127.0.0.1 -P 4000 -u root -D test --local-infile=true < issue52282_testcase.sql
issue52282_testcase.sql: 
drop table if exists `t`;
create table t (a int, b varchar(255), primary key (a)) partition by hash(a) partitions 2;
insert into t values (1, '1'), (2, '2'), (3, '3');
set @@tidb_partition_prune_mode='static';
select * from t tablesample regions();
set @@tidb_partition_prune_mode='dynamic';
select * from t tablesample regions();
set @@tidb_partition_prune_mode='static-only';
select * from t tablesample regions();
set @@tidb_partition_prune_mode='dynamic-only';
select * from t tablesample regions();
-----------------Test Result-----------------
Result : 
a	b
2	2
1	1
a	b
2	2
1	1
a	b
2	2
1	1
a	b
2	2
1	1
-----------------TiDB Version-----------------
tidb_version()
Release Version: v8.0.0-alpha-569-gd4ef3b269e-dirty
Edition: Community
Git Commit Hash: d4ef3b269e51e05688d76ef11ea36ccde51febad
Git Branch: HEAD
UTC Build Time: 2024-04-03 06:35:04
GoVersion: go1.21.4
Race Enabled: false
Check Table Before Drop: false
Store: unistore

-----------------End of regression test on d4ef3b269e51e05688d76ef11ea36ccde51febad-----------------
--------------------------------------------------------------------------------------
Bisecting: 2 revisions left to test after this (roughly 1 step)
[90e115f80bbb94ce74937a9fed826865af8438ae] ddl: fix add multi-indexes merge on partition tables (#52109) (#52118)
running  '/Users/yichenhan/workload/regression_detection//regression_detect_runtest.sh' '127.0.0.1' '4000' 'root' 'test' '/Users/yichenhan/workload/regression_detection/testcase/issue52282/issue52282_testcase.sql' '/Users/yichenhan/workload/regression_detection/testcase/issue52282/issue52282.result' '/Users/yichenhan/workload/regression_detection/testcase/issue52282' '/Users/yichenhan/dummy/tidb' '1' '100' '/Users/yichenhan/workload/regression_detection/testcase/issue52282/bisect-status-issue-52282.log'
CGO_ENABLED=1  GO111MODULE=on go build -tags codes  -ldflags '-X "github.com/pingcap/tidb/pkg/parser/mysql.TiDBReleaseVersion=v8.0.0-alpha-571-g90e115f80b-dirty" -X "github.com/pingcap/tidb/pkg/util/versioninfo.TiDBBuildTS=2024-04-03 06:35:54" -X "github.com/pingcap/tidb/pkg/util/versioninfo.TiDBGitHash=90e115f80bbb94ce74937a9fed826865af8438ae" -X "github.com/pingcap/tidb/pkg/util/versioninfo.TiDBGitBranch=HEAD" -X "github.com/pingcap/tidb/pkg/util/versioninfo.TiDBEdition=Community" ' -o bin/tidb-server ./cmd/tidb-server
Build TiDB Server successfully!
mysqld is alive
--------------------------------------------------------------------------------------
-----------------Regression Test Result on 90e115f80bbb94ce74937a9fed826865af8438ae-----------------
Server on 90e115f80bbb94ce74937a9fed826865af8438ae started.
Validation passed. 90e115f80bbb94ce74937a9fed826865af8438ae is a good label
-----------------Test Case-----------------
mysql -h 127.0.0.1 -P 4000 -u root -D test --local-infile=true < issue52282_testcase.sql
issue52282_testcase.sql: 
drop table if exists `t`;
create table t (a int, b varchar(255), primary key (a)) partition by hash(a) partitions 2;
insert into t values (1, '1'), (2, '2'), (3, '3');
set @@tidb_partition_prune_mode='static';
select * from t tablesample regions();
set @@tidb_partition_prune_mode='dynamic';
select * from t tablesample regions();
set @@tidb_partition_prune_mode='static-only';
select * from t tablesample regions();
set @@tidb_partition_prune_mode='dynamic-only';
select * from t tablesample regions();
-----------------Test Result-----------------
Result : 
a	b
2	2
1	1
a	b
2	2
1	1
a	b
2	2
1	1
a	b
2	2
1	1
-----------------TiDB Version-----------------
tidb_version()
Release Version: v8.0.0-alpha-571-g90e115f80b-dirty
Edition: Community
Git Commit Hash: 90e115f80bbb94ce74937a9fed826865af8438ae
Git Branch: HEAD
UTC Build Time: 2024-04-03 06:35:54
GoVersion: go1.21.4
Race Enabled: false
Check Table Before Drop: false
Store: unistore

-----------------End of regression test on 90e115f80bbb94ce74937a9fed826865af8438ae-----------------
--------------------------------------------------------------------------------------
Bisecting: 0 revisions left to test after this (roughly 1 step)
[43cf9a2245b91c647b46816ad3d5424ef90f1070] planner: apply rule_partition_pruning when optimizing CTE under static mode (#51903) (#52148)
running  '/Users/yichenhan/workload/regression_detection//regression_detect_runtest.sh' '127.0.0.1' '4000' 'root' 'test' '/Users/yichenhan/workload/regression_detection/testcase/issue52282/issue52282_testcase.sql' '/Users/yichenhan/workload/regression_detection/testcase/issue52282/issue52282.result' '/Users/yichenhan/workload/regression_detection/testcase/issue52282' '/Users/yichenhan/dummy/tidb' '1' '100' '/Users/yichenhan/workload/regression_detection/testcase/issue52282/bisect-status-issue-52282.log'
CGO_ENABLED=1  GO111MODULE=on go build -tags codes  -ldflags '-X "github.com/pingcap/tidb/pkg/parser/mysql.TiDBReleaseVersion=v8.0.0-alpha-573-g43cf9a2245-dirty" -X "github.com/pingcap/tidb/pkg/util/versioninfo.TiDBBuildTS=2024-04-03 06:36:31" -X "github.com/pingcap/tidb/pkg/util/versioninfo.TiDBGitHash=43cf9a2245b91c647b46816ad3d5424ef90f1070" -X "github.com/pingcap/tidb/pkg/util/versioninfo.TiDBGitBranch=HEAD" -X "github.com/pingcap/tidb/pkg/util/versioninfo.TiDBEdition=Community" ' -o bin/tidb-server ./cmd/tidb-server
Build TiDB Server successfully!
mysqld is alive
--------------------------------------------------------------------------------------
-----------------Regression Test Result on 43cf9a2245b91c647b46816ad3d5424ef90f1070-----------------
Server on 43cf9a2245b91c647b46816ad3d5424ef90f1070 started.
Validation failed at run 1. 43cf9a2245b91c647b46816ad3d5424ef90f1070 is a bad label.
Expected: 
a	b
2	2
1	1
a	b
2	2
1	1
a	b
2	2
1	1
a	b
2	2
1	1
Actual: 
a	b
2	2
1	1
2	2
1	1
a	b
2	2
1	1
a	b
2	2
1	1
2	2
1	1
a	b
2	2
1	1
-----------------Test Case-----------------
mysql -h 127.0.0.1 -P 4000 -u root -D test --local-infile=true < issue52282_testcase.sql
issue52282_testcase.sql: 
drop table if exists `t`;
create table t (a int, b varchar(255), primary key (a)) partition by hash(a) partitions 2;
insert into t values (1, '1'), (2, '2'), (3, '3');
set @@tidb_partition_prune_mode='static';
select * from t tablesample regions();
set @@tidb_partition_prune_mode='dynamic';
select * from t tablesample regions();
set @@tidb_partition_prune_mode='static-only';
select * from t tablesample regions();
set @@tidb_partition_prune_mode='dynamic-only';
select * from t tablesample regions();
-----------------Test Result-----------------
Result : 
a	b
2	2
1	1
2	2
1	1
a	b
2	2
1	1
a	b
2	2
1	1
2	2
1	1
a	b
2	2
1	1
-----------------TiDB Version-----------------
tidb_version()
Release Version: v8.0.0-alpha-573-g43cf9a2245-dirty
Edition: Community
Git Commit Hash: 43cf9a2245b91c647b46816ad3d5424ef90f1070
Git Branch: HEAD
UTC Build Time: 2024-04-03 06:36:31
GoVersion: go1.21.4
Race Enabled: false
Check Table Before Drop: false
Store: unistore

-----------------End of regression test on 43cf9a2245b91c647b46816ad3d5424ef90f1070-----------------
--------------------------------------------------------------------------------------
Bisecting: 0 revisions left to test after this (roughly 0 steps)
[c5dc6c5659118b8dde633f73f8f6760400ddca88] br: change default value to coarse-grained (#52120) (#52121)
running  '/Users/yichenhan/workload/regression_detection//regression_detect_runtest.sh' '127.0.0.1' '4000' 'root' 'test' '/Users/yichenhan/workload/regression_detection/testcase/issue52282/issue52282_testcase.sql' '/Users/yichenhan/workload/regression_detection/testcase/issue52282/issue52282.result' '/Users/yichenhan/workload/regression_detection/testcase/issue52282' '/Users/yichenhan/dummy/tidb' '1' '100' '/Users/yichenhan/workload/regression_detection/testcase/issue52282/bisect-status-issue-52282.log'
CGO_ENABLED=1  GO111MODULE=on go build -tags codes  -ldflags '-X "github.com/pingcap/tidb/pkg/parser/mysql.TiDBReleaseVersion=v8.0.0-alpha-572-gc5dc6c5659-dirty" -X "github.com/pingcap/tidb/pkg/util/versioninfo.TiDBBuildTS=2024-04-03 06:37:02" -X "github.com/pingcap/tidb/pkg/util/versioninfo.TiDBGitHash=c5dc6c5659118b8dde633f73f8f6760400ddca88" -X "github.com/pingcap/tidb/pkg/util/versioninfo.TiDBGitBranch=HEAD" -X "github.com/pingcap/tidb/pkg/util/versioninfo.TiDBEdition=Community" ' -o bin/tidb-server ./cmd/tidb-server
Build TiDB Server successfully!
mysqld is alive
--------------------------------------------------------------------------------------
-----------------Regression Test Result on c5dc6c5659118b8dde633f73f8f6760400ddca88-----------------
Server on c5dc6c5659118b8dde633f73f8f6760400ddca88 started.
Validation passed. c5dc6c5659118b8dde633f73f8f6760400ddca88 is a good label
-----------------Test Case-----------------
mysql -h 127.0.0.1 -P 4000 -u root -D test --local-infile=true < issue52282_testcase.sql
issue52282_testcase.sql: 
drop table if exists `t`;
create table t (a int, b varchar(255), primary key (a)) partition by hash(a) partitions 2;
insert into t values (1, '1'), (2, '2'), (3, '3');
set @@tidb_partition_prune_mode='static';
select * from t tablesample regions();
set @@tidb_partition_prune_mode='dynamic';
select * from t tablesample regions();
set @@tidb_partition_prune_mode='static-only';
select * from t tablesample regions();
set @@tidb_partition_prune_mode='dynamic-only';
select * from t tablesample regions();
-----------------Test Result-----------------
Result : 
a	b
2	2
1	1
a	b
2	2
1	1
a	b
2	2
1	1
a	b
2	2
1	1
-----------------TiDB Version-----------------
tidb_version()
Release Version: v8.0.0-alpha-572-gc5dc6c5659-dirty
Edition: Community
Git Commit Hash: c5dc6c5659118b8dde633f73f8f6760400ddca88
Git Branch: HEAD
UTC Build Time: 2024-04-03 06:37:02
GoVersion: go1.21.4
Race Enabled: false
Check Table Before Drop: false
Store: unistore

-----------------End of regression test on c5dc6c5659118b8dde633f73f8f6760400ddca88-----------------
--------------------------------------------------------------------------------------
43cf9a2245b91c647b46816ad3d5424ef90f1070 is the first bad commit
commit 43cf9a2245b91c647b46816ad3d5424ef90f1070
Author: Ti Chi Robot <ti-community-prow-bot@tidb.io>
Date:   Wed Mar 27 17:32:18 2024 +0800

    planner: apply rule_partition_pruning when optimizing CTE under static mode (#51903) (#52148)
    
    close pingcap/tidb#51873

 pkg/planner/core/casetest/BUILD.bazel         |  2 +-
 pkg/planner/core/casetest/integration_test.go | 32 +++++++++++++++++++++++++++
 pkg/planner/core/optimizer.go                 |  4 +++-
 3 files changed, 36 insertions(+), 2 deletions(-)
bisect found first bad commit